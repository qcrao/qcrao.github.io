<!doctype html><html lang=zh-cn><head><meta name=generator content="Hugo 0.104.1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><title>qcrao 的博客 | 专注于 Go 语言(golang)、后端架构、个人成长</title><meta property="og:title" content="qcrao 的博客 | 专注于 Go 语言(golang)、后端架构、个人成长"><meta property="og:type" content="website"><meta name=Keywords content="golang,go语言,后端,个人成长"><meta name=description content="一线互联网码农，热衷探究技术背后的原理。喜欢情景喜剧、相声、小品，阅读，终生学习者。"><meta property="og:url" content="https://qcrao.com/"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/style.css><link rel=alternate type=application/rss+xml href=https://qcrao.com/index.xml title="qcrao 的博客"><script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js></script>
<link href=https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css rel=stylesheet></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href=https://qcrao.com>qcrao 的博客</a></h1><p class=description>专注于 Go 语言(golang)、后端架构、个人成长</p></div><div><nav id=nav-menu class=clearfix><a class=current href=https://qcrao.com>首页</a>
<a href=https://qcrao.com/archives/ title=归档>归档</a>
<a href=https://qcrao.com/about/ title=关于>关于</a>
<a href=https://qcrao.com/readings/ title=阅读>阅读</a>
<a href=https://qcrao.com/ishare/ title=分享>分享</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/ingenious-use-of-channel/ title="Go channel 的妙用">Go channel 的妙用</a></h1></header><date class="post-meta meta-date">2021年2月4日</date><div class=post-content>昨天在内网上看到一篇讲数据库连接的文章，列出了一些 sql 包的一些源码，我注意到其中取用、归还连接的方式非常有意思——通过临时创建的 channel 来传递连接。 在 sql.DB 结构体里，使用 freeConn 字段来表示当前所有的连接，也就是一个连接池。 type DB struct { freeConn []*driverConn } 当需要拿连接的时候，从 freeConn 中取出第一个元素： conn := db.freeConn[0] copy(db.freeConn, db.freeConn[1:]) db.freeConn = db.freeConn[:numFree-1] conn.inUse =……</div><p class=readmore><a href=https://qcrao.com/post/ingenious-use-of-channel/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/error-depend-on-host-ip/ title="事故现场之依赖了不该依赖的 host ip">事故现场之依赖了不该依赖的 host ip</a></h1></header><date class="post-meta meta-date">2021年1月29日</date><div class=post-content>昨天，组里服务遇到了一个诡异的问题，跟着看了下原因，记录在此。 先介绍背景：我们维护了两个服务，一个对外服务，承接流量，称之为主服务，主服务会调用各种第三方 RPC 服务，获取各种字段，拼在一个大的 model 上。其中有一个 RPC 服务，称之为 E 服务，是我们自己维护的，它返回一部分字段。 E 服务会定时读取规……</div><p class=readmore><a href=https://qcrao.com/post/error-depend-on-host-ip/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/panic-blame-robot/ title="写一个 panic blame 机器人">写一个 panic blame 机器人</a></h1></header><date class="post-meta meta-date">2021年1月11日</date><div class=post-content>最近接手了一个“公共”服务，负责维护它的稳定性。代码库有很多人参与“维护”，其实就是各种业务方使劲往上堆逻辑。虽然入库前我会进行 CR，但多了之后，也看不过来，还有一些人自己偷摸就把代码合到 master 上去了。总之，代码质量无法得到很好的保证。 当然了，如果把合代码的权限收敛到我一个人，理论上……</div><p class=readmore><a href=https://qcrao.com/post/panic-blame-robot/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/become-contributor-of-redir/ title="喜提 redir contributor">喜提 redir contributor</a></h1></header><date class="post-meta meta-date">2020年11月16日</date><div class=post-content>看多了 Go 源代码，看一看应用，尤其是比较短小且有趣的应用代码，感觉很有意思，而且举重若轻。 如果顺带修一下小的错误，成为 Contributor，那就更多了一种成就感。就像杨文前几天成为 Go Contributor 那样，从小处开始，慢慢提升技术含量，总有一天，慢慢成为真正的 Contributor，像曹大那样。……</div><p class=readmore><a href=https://qcrao.com/post/become-contributor-of-redir/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/concurrency-in-go-reading-notes/ title="深度阅读之《Concurrency in Go》">深度阅读之《Concurrency in Go》</a></h1></header><date class="post-meta meta-date">2020年9月5日</date><div class=post-content>作为一个终身学习者，输入和输出是必不可少的。输入多了之后，会发现很多中文文章很难读，可能还有很多错漏之处。不客气地说，输入的是垃圾，输出的只能是垃圾。 曹大经常说需要多看英文资料，包括各种新出的英文书、文章等等，这从他的书单也可以看出来。我自己的情况是：英文资料读的不多，英文技术书……</div><p class=readmore><a href=https://qcrao.com/post/concurrency-in-go-reading-notes/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/head-first-design-pattern-reading-notes/ title="《Head First 设计模式》读书笔记">《Head First 设计模式》读书笔记</a></h1></header><date class="post-meta meta-date">2020年5月10日</date><div class=post-content>第一章 设计模式入门 使用模式最好的方式是：”把模式装进脑子里，然后在你的设计和已有的应用中，寻找何处可以使用它们。” 通过一个给 Duck 类型添加 fly 功能的实例，一步步地提出解决方案。 先是使用继承，但是继承并不能很好地解决问题，因为鸭子的行为在子类里不断地改变，并且让所有的子类都有这些行为是不……</div><p class=readmore><a href=https://qcrao.com/post/head-first-design-pattern-reading-notes/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/dive-into-go-sync-map/ title="深度解密 Go 语言之 sync.map">深度解密 Go 语言之 sync.map</a></h1></header><date class="post-meta meta-date">2020年5月6日</date><div class=post-content>工作中，经常会碰到并发读写 map 而造成 panic 的情况，为什么在并发读写的时候，会 panic 呢？因为在并发读写的情况下，map 里的数据会被写乱，之后就是 Garbage in, garbage out，还不如直接 panic 了。 是什么 Go 语言原生 map 并不是线程安全的，对它进行并发读写操作的时候，需要加锁。而 sync.map 则是一种并发安全的 map，在 Go 1.9 引入。 sync.map……</div><p class=readmore><a href=https://qcrao.com/post/dive-into-go-sync-map/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/codec-accident/ title=『���』引发的线上事故>『���』引发的线上事故</a></h1></header><date class="post-meta meta-date">2020年4月27日</date><div class=post-content>最近遇到了一起依赖升级 + 异常数据引发的线上事故，教训惨痛，本文对此进行回故和总结。 背景 起因是我们使用的服务框架版本比较老，GC 次数的 metrics 打点一直为 0，咨询了相关同学后，决定升级框架。升级的过程中，出现了 use of internal package xxx not allowed 的报错，又咨询了一下相关同学后，尝试使用 go mod 解决。 从 go vendor 到 go mod 的升……</div><p class=readmore><a href=https://qcrao.com/post/codec-accident/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/dive-into-go-sync-pool/ title="深度解密 Go 语言之 sync.pool">深度解密 Go 语言之 sync.pool</a></h1></header><date class="post-meta meta-date">2020年4月20日</date><div class=post-content>最近在工作中碰到了 GC 的问题：项目中大量重复地创建许多对象，造成 GC 的工作量巨大，CPU 频繁掉底。准备使用 sync.Pool 来缓存对象，减轻 GC 的消耗。为了用起来更顺畅，我特地研究了一番，形成此文。本文从使用到源码解析，循序渐进，一一道来。 本文基于 Go 1.14 是什么 sync.Pool 是 sync 包下的一个组件，可以作为保存临时取还对……</div><p class=readmore><a href=https://qcrao.com/post/dive-into-go-sync-pool/>阅读全文</a></p></article><article class=post><header><h1 class=post-title><a href=https://qcrao.com/post/talk-about-g0/ title="聊聊 g0">聊聊 g0</a></h1></header><date class="post-meta meta-date">2020年4月3日</date><div class=post-content>很多时候，当我们跟着源码去理解某种事物时，基本上可以认为是以时间顺序展开，这是编年体的逻辑。还有另一种逻辑，纪传体，它以人物为中心编排史事，使得读者更聚焦于某个人物。以一种新的视角，把所有的事情串连起来，令人大呼过瘾。今天我们试着以这样一种逻辑再看 g0。 回顾一下 Go 夜读第 78 期，关于……</div><p class=readmore><a href=https://qcrao.com/post/talk-about-g0/>阅读全文</a></p></article><ol class=page-navigator><li class=prev><a href=https://qcrao.com/page/2/>上一页</a></li><li><a href=https://qcrao.com/>1</a></li><li><a href=https://qcrao.com/page/2/>2</a></li><li class=current><a href=https://qcrao.com/page/3/>3</a></li><li><a href=https://qcrao.com/page/4/>4</a></li><li><a href=https://qcrao.com/page/5/>5</a></li><li><a href=https://qcrao.com/page/6/>6</a></li><li class=next><a href=https://qcrao.com/page/4/>下一页</a></li></ol></div><footer id=footer><div>&copy; 2022 <a href=https://qcrao.com>qcrao 的博客 By 饶全成</a>
| <a rel=nofollow target=_blank href=http://beian.miit.gov.cn/>鄂ICP备20006251号-1</a></div><br><div><div class=github-badge><a href=https://gohugo.io/ target=_black rel=nofollow><span class=badge-subject>Powered by</span><span class="badge-value bg-blue">Hugo</span></a></div><div class=github-badge><a href=https://www.flysnow.org/ target=_black><span class=badge-subject>Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a></div><div class=github-badge><a href=https://github.com/flysnow-org/maupassant-hugo target=_black><span class=badge-subject>Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a></div></div></footer><a id=rocket href=#top></a>
<script type=text/javascript src='/js/totop.js?v=0.0.0' async></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-144930666-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script type=text/javascript src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async></script>
<script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "15ed44493a8a4df682815ddf8c84ff23"}'></script></div><div id=secondary><section class=widget><form id=search action=https://qcrao.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=https://qcrao.com>
<button type=submit class="submit icon-search"></button></form></section><section class=widget><h3 class=widget-title>最近文章</h3><ul class=widget-list><li><a href=https://qcrao.com/post/what-is-upstream-downstream/ title="你说的下游是 upstream 吧？">你说的下游是 upstream 吧？</a></li><li><a href=https://qcrao.com/post/migrate-blog-to-cloudflare-pages/ title="将博客迁移到了 Cloudflare Pages">将博客迁移到了 Cloudflare Pages</a></li><li><a href=https://qcrao.com/post/blogs-written-by-xargin/ title=那些年曹大写的文章>那些年曹大写的文章</a></li><li><a href=https://qcrao.com/post/content-is-more-important/ title=最重要的是内容>最重要的是内容</a></li><li><a href=https://qcrao.com/post/look-up-go-doc-gracefully/ title="写 Go 时如何优雅地查文档">写 Go 时如何优雅地查文档</a></li><li><a href=https://qcrao.com/post/talk-about-map-extra-field/ title="曹大带我学 Go（11）—— 从 map 的 extra 字段谈起">曹大带我学 Go（11）—— 从 map 的 extra 字段谈起</a></li><li><a href=https://qcrao.com/post/go-tls-pr-by-xargin/ title="曹大带我学 Go（10）—— 如何给 Go 提性能优化的 pr">曹大带我学 Go（10）—— 如何给 Go 提性能优化的 pr</a></li><li><a href=https://qcrao.com/post/start-to-build-up-personal-tools/ title="曹大带我学 Go（9）—— 开始积累自己的工具库">曹大带我学 Go（9）—— 开始积累自己的工具库</a></li><li><a href=https://qcrao.com/post/accident-by-a-metric/ title="曹大带我学 Go（8）—— 一个 metrics 打点引发的事故">曹大带我学 Go（8）—— 一个 metrics 打点引发的事故</a></li><li><a href=https://qcrao.com/post/how-to-use-functional-options-pattern/ title="曹大带我学 Go（7）—— 如何优雅地指定配置项">曹大带我学 Go（7）—— 如何优雅地指定配置项</a></li></ul></section><section class=widget><h3 class=widget-title>我写的书</h3><ul class=widget-list><li><a href=https://golang.design/go-questions/ title="《Go 程序员面试笔试宝典》" target=_blank style=color:red><img src=/book.png></a></li></ul></section><section class=widget><h3 class=widget-title>友情链接</h3><ul class=widget-list><li><a target=_blank href=https://www.xargin.com/ title=曹大的博客>曹大的博客</a></li><li><a target=_blank href=https://eddycjy.com/ title=煎鱼的博客>煎鱼的博客</a></li><li><a target=_blank href=http://lessisbetter.site/ title=大彬的博客>大彬的博客</a></li><li><a target=_blank href=https://wujunze.com/ title="Panda 的博客">Panda 的博客</a></li><li><a target=_blank href=https://mytechshares.com/ title=董泽润>董泽润</a></li></ul></section><section class=widget><h3 class=widget-title>其它</h3><ul class=widget-list><li><a href=https://qcrao.com/index.xml>文章 RSS</a></li></ul></section></div></div></div></div></body></html>