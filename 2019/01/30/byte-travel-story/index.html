<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="日拱一卒，终有所成！"><title>一个字节的网络漫游故事独白 | qcrao</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-144930666-1','auto');ga('send','pageview');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '6d54b847f6c5fb175b1ed2d153159403';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">一个字节的网络漫游故事独白</h1><a id="logo" href="/.">qcrao</a><p class="description">码农桃花源</p></div><div id="nav-menu"><a href="/"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/readings/"><i class="fa fa-book"> 阅读</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">一个字节的网络漫游故事独白</h1><div class="post-meta">Jan 30, 2019<span> | </span><span class="category"><a href="/categories/网络/">网络</a></span><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.6k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 8</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#诞生"><span class="toc-number">1.</span> <span class="toc-text">诞生</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#上路"><span class="toc-number">2.</span> <span class="toc-text">上路</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#新生"><span class="toc-number">3.</span> <span class="toc-text">新生</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#归家"><span class="toc-number">4.</span> <span class="toc-text">归家</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#定格"><span class="toc-number">5.</span> <span class="toc-text">定格</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#后记"><span class="toc-number">6.</span> <span class="toc-text">后记</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考资料"><span class="toc-number">7.</span> <span class="toc-text">参考资料</span></a></li></ol></div></div><div class="post-content"><p>大家好，给大家介绍一下，我是一个字节。相比于你们人类据说即将达到的百岁人生的寿命，我的一生简直不直一提（我只能存活零点几个毫秒）。</p>
<p>也许只有那些码农才会了解我，而且也只有一部分码农。那些整天做业务的猿们想来也不会真正的了解我，更别提人类其他行业的人了。</p>
<p>我不甘心，虽然我微不足道，但是我对人类的贡献实在是太大了。没有我的世界根本无法想像：不能听网易云音乐，不能刷抖音，不能上拼多多，所有和网络相关的活动都无法进行。</p>
<p>所以，今天我要讲讲我的一生，让更多的人知道我的存在，知道我的故事，也为证明自己曾经存在过吧。</p>
<h1 id="诞生"><a href="#诞生" class="headerlink" title="诞生"></a>诞生</h1><p>我的主人是一个在西二旗知名互联网公司上班的程序猿，过着1095（注：早10点晚9点，一周5天工作）的生活，很少能在晚霞中回家，自然也说不出“落霞与孤鹜齐飞”那样的句子。</p>
<p>这一天，他9点半到家，第一件事打开电脑，熟练地启动chrome浏览器，在地址栏敲下一个<code>z</code>字符，我所有的故事就从这里开始。</p>
<p>当主人按下键盘上的<code>z</code>键时，系统了产生一个中断信号，通知CPU过来读取键盘输入，CPU读取到<code>z</code>后，将<code>z</code>发送给chrome浏览器, chrome收到后，将<code>z</code>显示到浏览器的地址栏上，同时后台搜索主人平时访问过的地址，排名第一的<code>https://www.zhihu.com/</code>被快速补全了。</p>
<p>这时主人熟练地按下了回车键，chrome收到指令后，进行了一顿操作，在这电光火石之间，我诞生了，同时诞生的还有我的字节兄弟们。</p>
<h1 id="上路"><a href="#上路" class="headerlink" title="上路"></a>上路</h1><p>话说<code>Chorme老大哥</code>接收到了URL后，首先拆解成自己能看懂的东西。<code>https://www.zhihu.com</code>会被拆解成三部分：<code>https</code>、<code>www.zhihu.com</code>、<code>/</code></p>
<p><code>https</code>表示协议类型，通过这个<code>Chorme老大哥</code>知道他接下来该如何与远方的网站服务器通信；<code>www.zhihu.com</code>表示主机名，就是Chorme老大哥要通信的对象了；第三部分则是它要向服务器要的内容（注：这里表明是空，实际上隐含的表示主目录文件的概念）。</p>
<p>有了这三项，<code>Chorme老大哥</code>就能从服务器那里获取它想要的内容了，从而展示给我的主人。</p>
<p><code>Chorme老大哥</code>跑到<code>HTTP数据包生产车间</code>，哼哧哼哧地倒腾半天，生产出了一个HTTP数据包（注：忽略https, 简单起见我们当成http），这个数据包实际上就是我和我的一群字节兄弟们，我们挤在一个集装箱内，熙熙攘攘。</p>
<p>我们马上就要搭乘<code>IP列车</code>到远方的服务器，见识外面的世界了。集装箱被装上了<code>TCP专车</code>，它将带我们来到列车站。<code>TCP专车</code>很安全也很舒适，我从集装箱的缝隙中看到车前贴上了车牌：<code>80</code>. </p>
<p>到了车站，<code>TCP专车</code>直接开到了列车上。这样也好，<code>IP列车</code>上很脏，我们坐在专车上更好。 只是列车还不知道具体要去哪，所以我们就只能先在列车上等着了。</p>
<p>不对啊，列车应该去<code>www.zhihu.com</code>这个网站，不是已经知道了吗？对的，但是<code>IP列车</code>挺笨的，也挺古板的，不认识这些字母。它只认识数字，人类称之为ip. </p>
<p><code>Chorme老大哥</code>也有点抱怨，人类真是笨，连个ip都记不住，非得用域名来上网。害我还得拿着这个域名去问<code>DNS老大爷</code>，它知道所有域名对应的ip. </p>
<p>这不，<code>Chorme老大哥</code>又跑到另外一个车间————<code>DNS数据包生产车间</code>里倒腾出了一个DNS数据包，当然还是一群字节兄弟们，不过这里的兄弟就少一些了。它们在集装箱里叽叽喳喳，被装上了<code>UDP敞篷车</code>，车虽然很快，但不太安全，我这些兄弟们坐在上面，提心吊胆，生怕掉下去，因为掉下去，就永远消失了。</p>
<p><code>UDP敞篷车</code>也直接开到了<code>IP列车</code>上，车前贴了车牌：53.</p>
<p>这回Chrome老大哥直接从<code>操作系统大佬</code>那要到了<code>DNS老大爷</code>的ip, 贴到了<code>IP列车</code>的车头，<code>IP列车</code>马上全速启动，载着我这些字节兄弟，赶到了<code>DNS老大爷</code>的城堡，<code>UDP敞篷车</code>开下列车，按照车牌号53找到了<code>DNS老大爷</code>的住处。从它那拿到了<code>www.zhihu.com</code>对应的ip.</p>
<p><code>DNS老大爷</code>学问渊博，他也很仗义，从自己城堡里的<code>DNS数据包生产车间</code>造出了DNS响应包，包里也是我这些字节兄弟们，它们拿着重要的资料数据————<code>www.zhihu.com</code>对应的ip, 坐上了另一趟返程的<code>IP列车</code>，而列车的终点就是我现在所在的地方。当然了，他们是由另一辆<code>UDP敞篷车</code>载着他们回来的。</p>
<p><code>Chorme老大哥</code>在车间接见了这些兄弟，非常感动。因为他们带回了<code>www.zhihu.com</code>对应的ip. 那些兄弟争先恐后的报告自己知道的东西，有些兄弟报告1, 有些兄弟报告0, <code>Chorme老大哥</code>非常有经验，它把这些消息合并起来了，最终得到了它想要的ip: 118.89.204.192.</p>
<p><code>Chorme老大哥</code>拿着这个ip来到了我所在的列车前面，我激动地要叫起来了：终于我要出发了！它熟练地把<code>118.89.204.192</code>贴到了列车的前面，马上列车就开动了，我上路了。</p>
<p><code>IP列车</code>的列车长在掌管着车头的方向，决定着我们的命运走向。路网非常复杂，而车头上只有一个ip地址，根本没告诉列车长应该走哪条路。这不难，富有经验的列车长根据车头的ip地址查到了下一个大站（路由器）的地址，之后再根据这个大站地址查到（ARP协议）途经的下一个小站（交换机或集线器）应该走的轨道。在每个小站，对照这个大站地址，列车长就知道该走哪条路。搞定！</p>
<p>经过了很多的小站，我们终于到了下一个大站了。站点的工作人员看着我们车头前的ip地址，查了下表（路由表）告诉我们下一个大站的地址，并且告诉我们途径的下一个小站应该走哪条轨道。列车长就这样，一路拿这张表，顺利地把们带到了终点：<br><code>118.89.204.192</code>. </p>
<p>不过，刚刚就在到终点的前一刻，列车被拦住了，一群荷枪实弹的警卫冲上来了，一些胆小的字节兄弟们都哭了，我也是屏气凝声。他们先是查看了车头的ip地址，再查看了列车长手里的表，还看了下我们的<code>TCP专车</code>的车牌。很快就放行了，虚惊一场！</p>
<h1 id="新生"><a href="#新生" class="headerlink" title="新生"></a>新生</h1><p>到了终点站后，列车首先停下接受工作人员的检查。列车长出示了他手里的表，对了一下表上标注的下一站地址确实是：知乎。接着又看了下列车头部标注的ip地址，就算检查通过了，第一关很轻松。</p>
<p>接下来，我们坐的<code>TCP专车</code>开下列车了。进了一个<code>TCP车牌检查站</code>，工作人员看了下车牌号80, 也挥手示意我们通过。</p>
<p>接着我们都下车走进了<code>主页车间</code>，进去后，我们先按我们身上的标号排好了位置，工作人员将我们每个人所代表的信息进行了聚拢。得到了各种关于主人的信息，比如他所用的浏览器的版本，cookie等等信息，我知道，我们的使命完成了。果然，一道光闪过，我们都消失了，完成了我们光荣的一生。</p>
<p><code>主页车间</code>领导马上下达生产命令：1组去仓库拉取最新话题，2组去商业中心获取今天的广告主信息……</p>
<p>很快，各组都完成了任务，车间在一阵轰鸣过后，新的一批字节兄弟诞生了，他们带着这些话题、广告信息，和我们当年出生的时候一样，熙熙攘攘。但是我知道，我获得了新生。</p>
<h1 id="归家"><a href="#归家" class="headerlink" title="归家"></a>归家</h1><p>像我们当年一样，这些新出生的字节兄弟依次坐上了<code>TCP专车</code>，<code>IP列车</code>一路跋涉，去往我出发的地方，那是我梦开始的地方。</p>
<p>我所经历的，他们未曾少过一分。</p>
<h1 id="定格"><a href="#定格" class="headerlink" title="定格"></a>定格</h1><p><code>Chrome老大哥</code>终于等来了这些字节兄弟，在他们排好队后，老大哥看清了字节兄弟们代表的内容：话题<code>如何在西二旗地铁优雅地装逼</code>，热度10w, 广告<code>上午植发，下午上班</code>……</p>
<p>这些是<code>Chrome老大哥</code>最擅长的事情，分分钟将他们显示在了网页上。字节兄弟们终于完成了使命，定格在了retina屏幕上。</p>
<p>我的主人点开第一话题后，看了一会儿。然后瞅到了到植发广告，他偷偷地开启了隐身模式，仔细地研究了起来……</p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>第一次尝试这种题材的文章，供大家一乐！有写得不到位的地方，欢迎大家补充！</p>
<p>另外，推荐大家去看《网络是怎样连接的》，看完可以形成对网络的整体印象。写得非常好！</p>
<p><img src="/2019/01/30/byte-travel-story/1.png" alt="QR"></p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>【知乎回答】<a href="https://www.zhihu.com/question/292704461/answer/482549197" target="_blank" rel="noopener">https://www.zhihu.com/question/292704461/answer/482549197</a></p>
<p>【当我们谈网络时】<a href="https://segmentfault.com/a/1190000004094420" target="_blank" rel="noopener">https://segmentfault.com/a/1190000004094420</a></p>
<p>【按下键盘时】<a href="https://www.zhihu.com/question/29707696" target="_blank" rel="noopener">https://www.zhihu.com/question/29707696</a></p>
<p>【mac地址和ip地址】<a href="http://blog.sciencenet.cn/blog-411071-1037673.html" target="_blank" rel="noopener">http://blog.sciencenet.cn/blog-411071-1037673.html</a></p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>饶全成</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2019/01/30/byte-travel-story/">https://qcrao.com/2019/01/30/byte-travel-story/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本文章著作权归作者所有，任何形式的转载都请注明出处。</li></ul></div><br><div class="tags"><a href="/tags/协议/">协议</a></div><div class="post-nav"><a class="pre" href="/2019/02/12/how-to-keep-off-trap-of-defer/">Golang之轻松化解defer的温柔陷阱</a><a class="next" href="/2019/01/18/dive-into-http/">深度解密HTTP通信细节</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: '7e91ec94cfb5913e3d6b',
  clientSecret: '902f91e26bc75c9f8d912557492476d0be254667',
  repo: 'qcrao.github.io',
  owner: 'qcrao',
  admin: ['qcrao'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://qcrao.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/性能优化/">性能优化</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/操作系统/">操作系统</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/求职/">求职</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程语言/">编程语言</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络/">网络</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/内存重排/" style="font-size: 15px;">内存重排</a> <a href="/tags/故障排查/" style="font-size: 15px;">故障排查</a> <a href="/tags/协议/" style="font-size: 15px;">协议</a> <a href="/tags/golang/" style="font-size: 15px;">golang</a> <a href="/tags/HTTP/" style="font-size: 15px;">HTTP</a> <a href="/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/编译原理/" style="font-size: 15px;">编译原理</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/简历/" style="font-size: 15px;">简历</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/06/07/linux-performance-reading-notes/">《Linux 性能优化》读书笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/10/head-first-design-pattern-reading-notes/">《Head First 设计模式》读书笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/06/dive-into-go-sync-map/">深度解密Go语言之sync.map</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/27/codec-accident/">“���”引发的线上事故</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/20/dive-into-go-sync-pool/">深度解密Go语言之sync.pool</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/03/talk-about-g0/">聊聊 g0</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/23/how-to-traverse-defer-links/">defer 链表如何被遍历执行</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/08/high-performance-mysql-reading-notes/">《高性能 MySQL》读书笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/10/dive-into-go-pprof/">深度解密Go语言之pprof</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/09/18/golang-error-break-through/">Golang error 的突围</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/qcrao/Go-Questions" title="Go-Questions" target="_blank">Go-Questions</a><ul></ul><a href="http://xargin.com/" title="No HeadBack" target="_blank">No HeadBack</a><ul></ul><a href="https://draveness.me/" title="面向信仰编程" target="_blank">面向信仰编程</a><ul></ul><a href="https://eddycjy.gitbook.io/golang/" title="跟煎鱼学 Go" target="_blank">跟煎鱼学 Go</a><ul></ul><a href="http://lessisbetter.site/" title="大彬 - Less is better" target="_blank">大彬 - Less is better</a><ul></ul><a href="https://wujunze.com/" title="Panda - Just for fun" target="_blank">Panda - Just for fun</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async="async"></script><span> | </span><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span> | </span><i class="fa fa-keyboard-o"></i><span class="post-count">171.8k</span><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">qcrao.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a><a rel="nofollow" target="_blank" href="http://www.beian.miit.gov.cn"> 鄂ICP备20006251号-1</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>